<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ë²„ë ˆì´ ë™ê¸°í™” ë„êµ¬</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f2f5;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .method {
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            background: #f8f9fa;
        }
        
        .method.active {
            border-color: #007bff;
            background: #e7f3ff;
        }
        
        .method h3 {
            color: #333;
            margin-top: 0;
        }
        
        .url-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            word-break: break-all;
            margin: 10px 0;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .copy-btn {
            background: #28a745;
        }
        
        .copy-btn:hover {
            background: #1e7e34;
        }
        
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ ì˜¤ë²„ë ˆì´ ë™ê¸°í™” ë„êµ¬</h1>
        <p>GitHub API ë¬¸ì œ ì—†ì´ ì˜¤ë²„ë ˆì´ë¥¼ ë™ê¸°í™”í•˜ëŠ” ì—¬ëŸ¬ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
        
        <div class="method active" id="method1">
            <h3>1. URL íŒŒë¼ë¯¸í„° ë°©ì‹ (ì¶”ì²œ)</h3>
            <p>í˜„ì¬ ë°ì´í„°ë¥¼ URLì— í¬í•¨ì‹œì¼œ ì–´ë–¤ ì»´í“¨í„°ì—ì„œë“  ë™ì¼í•˜ê²Œ í‘œì‹œ</p>
            
            <button onclick="generateUrls()">í˜„ì¬ ë°ì´í„°ë¡œ URL ìƒì„±</button>
            <button onclick="loadFromDonationManager()">donation-manager.htmlì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</button>
            
            <div id="url-results" style="display: none;">
                <h4>ìƒì„±ëœ ì˜¤ë²„ë ˆì´ URL:</h4>
                
                <p><strong>í›„ì›ì ì˜¤ë²„ë ˆì´:</strong></p>
                <div class="url-box" id="donor-url"></div>
                <button class="copy-btn" onclick="copyUrl('donor-url')">ë³µì‚¬</button>
                <button onclick="testUrl('donor-url')">í…ŒìŠ¤íŠ¸</button>
                
                <p><strong>ìŠ¤íŠ¸ë¦¬ë¨¸ í…Œì´ë¸” ì˜¤ë²„ë ˆì´:</strong></p>
                <div class="url-box" id="table-url"></div>
                <button class="copy-btn" onclick="copyUrl('table-url')">ë³µì‚¬</button>
                <button onclick="testUrl('table-url')">í…ŒìŠ¤íŠ¸</button>
                
                <div class="status info">
                    <strong>ì‚¬ìš©ë²•:</strong> ìƒì„±ëœ URLì„ OBS ë¸Œë¼ìš°ì € ì†ŒìŠ¤ì— ë¶™ì—¬ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.
                    ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œë„ ë™ì¼í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.
                </div>
            </div>
        </div>
        
        <div class="method" id="method2">
            <h3>2. ë¡œì»¬ ì›¹ì„œë²„ ë°©ì‹</h3>
            <p>ê°„ë‹¨í•œ ë¡œì»¬ ì›¹ì„œë²„ë¥¼ ì‹¤í–‰í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ë‚´ ëª¨ë“  ê¸°ê¸°ì—ì„œ ì ‘ê·¼</p>
            
            <div class="status warning">
                <strong>Pythonì´ ì„¤ì¹˜ëœ ê²½ìš°:</strong><br>
                1. ì´ í´ë”ì—ì„œ í„°ë¯¸ë„ ì—´ê¸°<br>
                2. <code>python -m http.server 8080</code> ì‹¤í–‰<br>
                3. ë¸Œë¼ìš°ì €ì—ì„œ <code>http://localhost:8080/donor-overlay.html</code> ì ‘ê·¼<br>
                4. ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œëŠ” <code>http://[ë‚´IP]:8080/donor-overlay.html</code> ì ‘ê·¼
            </div>
            
            <div class="status warning">
                <strong>Node.jsê°€ ì„¤ì¹˜ëœ ê²½ìš°:</strong><br>
                1. <code>npx http-server -p 8080</code> ì‹¤í–‰<br>
                2. í‘œì‹œëœ URLë¡œ ì ‘ê·¼
            </div>
            
            <button onclick="showLocalIp()">ë‚´ IP ì£¼ì†Œ í™•ì¸</button>
            <div id="ip-result"></div>
        </div>
        
        <div class="method" id="method3">
            <h3>3. ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì±„ë„ ë°©ì‹</h3>
            <p>ê°™ì€ ë¸Œë¼ìš°ì € ë‚´ì—ì„œ íƒ­ ê°„ ì‹¤ì‹œê°„ ë™ê¸°í™”</p>
            
            <button onclick="enableBroadcast()">ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì±„ë„ í™œì„±í™”</button>
            <button onclick="testBroadcast()">ë™ê¸°í™” í…ŒìŠ¤íŠ¸</button>
            
            <div id="broadcast-status"></div>
            
            <div class="status info">
                <strong>ì‚¬ìš©ë²•:</strong> 
                1. donation-manager.htmlê³¼ ì˜¤ë²„ë ˆì´ë¥¼ ê°™ì€ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸°<br>
                2. ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì±„ë„ í™œì„±í™”<br>
                3. donation-managerì—ì„œ ë°ì´í„° ë³€ê²½ ì‹œ ì˜¤ë²„ë ˆì´ì— ìë™ ë°˜ì˜
            </div>
        </div>
        
        <div class="method" id="method4">
            <h3>4. í´ë¦½ë³´ë“œ ë™ê¸°í™” ë°©ì‹</h3>
            <p>í´ë¦½ë³´ë“œë¥¼ í†µí•œ ìˆ˜ë™ ë™ê¸°í™”</p>
            
            <button onclick="exportToClipboard()">í˜„ì¬ ë°ì´í„°ë¥¼ í´ë¦½ë³´ë“œë¡œ ë³µì‚¬</button>
            <button onclick="importFromClipboard()">í´ë¦½ë³´ë“œì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</button>
            
            <div id="clipboard-status"></div>
            
            <div class="status info">
                <strong>ì‚¬ìš©ë²•:</strong> 
                1. donation-managerì—ì„œ "í´ë¦½ë³´ë“œë¡œ ë³µì‚¬"<br>
                2. ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œ ì˜¤ë²„ë ˆì´ ì—´ê¸°<br>
                3. "í´ë¦½ë³´ë“œì—ì„œ ê°€ì ¸ì˜¤ê¸°" ì‹¤í–‰
            </div>
        </div>
    </div>

    <script>
        let currentData = null;
        
        // GitHub Pages ê¸°ë³¸ URL
        const GITHUB_BASE = 'https://fzsaxzzzzzzzzzzzzz.github.io/donation-manager/';
        
        // 1. URL íŒŒë¼ë¯¸í„° ë°©ì‹
        function generateUrls() {
            // í˜„ì¬ donation-managerì—ì„œ ë°ì´í„° ë¡œë“œ ì‹œë„
            loadFromDonationManager();
        }
        
        function loadFromDonationManager() {
            try {
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
                const donations = JSON.parse(localStorage.getItem('donation_data') || '[]');
                const streamers = JSON.parse(localStorage.getItem('streamer_config') || '[]');
                const emojis = JSON.parse(localStorage.getItem('streamer_emojis') || '{}');
                
                // ì„¤ì • ë°ì´í„°
                const settings = {
                    'overlay-font-size': localStorage.getItem('overlay-font-size') || '16',
                    'overlay-stroke-width': localStorage.getItem('overlay-stroke-width') || '2',
                    'overlay-text-align': localStorage.getItem('overlay-text-align') || 'left',
                    'table-opacity': localStorage.getItem('table-opacity') || '85',
                    'table-number-size': localStorage.getItem('table-number-size') || '16',
                    'table-font-size': localStorage.getItem('table-font-size') || '14',
                    'table-text-color': localStorage.getItem('table-text-color') || 'white',
                    'hidden-streamers': localStorage.getItem('hidden-streamers') || '[]',
                    'group-threshold': localStorage.getItem('group-threshold') || '1',
                    'show-total-row': localStorage.getItem('show-total-row') || 'true',
                    'show-update-time': localStorage.getItem('show-update-time') || 'false',
                    'table-title': localStorage.getItem('table-title') || 'ğŸ† ìŠ¤íŠ¸ë¦¬ë¨¸ë³„ í›„ì› í˜„í™© ğŸ†'
                };
                
                currentData = {
                    donations: donations,
                    streamers: streamers,
                    emojis: emojis,
                    settings: settings,
                    lastUpdated: new Date().toISOString()
                };
                
                // Base64ë¡œ ì¸ì½”ë”©
                const dataString = JSON.stringify(currentData);
                const encodedData = btoa(encodeURIComponent(dataString));
                
                // URL ìƒì„±
                const donorUrl = `${GITHUB_BASE}donor-overlay.html?data=${encodedData}`;
                const tableUrl = `${GITHUB_BASE}streamer-table-overlay.html?data=${encodedData}`;
                
                document.getElementById('donor-url').textContent = donorUrl;
                document.getElementById('table-url').textContent = tableUrl;
                document.getElementById('url-results').style.display = 'block';
                
                showStatus('success', `âœ… URL ìƒì„± ì™„ë£Œ! (ë°ì´í„°: ${donations.length}ê°œ í›„ì›, ${streamers.length}ëª… ìŠ¤íŠ¸ë¦¬ë¨¸)`);
                
            } catch (error) {
                showStatus('warning', 'âŒ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. donation-manager.htmlì„ ë¨¼ì € ì—´ì–´ì£¼ì„¸ìš”.');
                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }
        
        function copyUrl(elementId) {
            const element = document.getElementById(elementId);
            const url = element.textContent;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    showStatus('success', 'âœ… URLì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                });
            } else {
                // êµ¬í˜• ë¸Œë¼ìš°ì € í˜¸í™˜
                const textarea = document.createElement('textarea');
                textarea.value = url;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showStatus('success', 'âœ… URLì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        }
        
        function testUrl(elementId) {
            const element = document.getElementById(elementId);
            const url = element.textContent;
            window.open(url, '_blank');
        }
        
        // 2. ë¡œì»¬ ì›¹ì„œë²„ ë°©ì‹
        function showLocalIp() {
            // WebRTCë¥¼ ì‚¬ìš©í•œ ë¡œì»¬ IP í™•ì¸
            const pc = new RTCPeerConnection({iceServers: []});
            pc.createDataChannel('');
            
            pc.createOffer().then(offer => pc.setLocalDescription(offer));
            
            pc.onicecandidate = (event) => {
                if (event.candidate) {
                    const candidate = event.candidate.candidate;
                    const ip = candidate.split(' ')[4];
                    
                    if (ip && ip !== '0.0.0.0' && !ip.includes(':')) {
                        document.getElementById('ip-result').innerHTML = `
                            <div class="status info">
                                <strong>ë‚´ IP ì£¼ì†Œ:</strong> ${ip}<br>
                                <strong>ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œ ì ‘ê·¼ URL:</strong><br>
                                â€¢ http://${ip}:8080/donor-overlay.html<br>
                                â€¢ http://${ip}:8080/streamer-table-overlay.html
                            </div>
                        `;
                        pc.close();
                    }
                }
            };
        }
        
        // 3. ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì±„ë„ ë°©ì‹
        let broadcastChannel = null;
        
        function enableBroadcast() {
            try {
                broadcastChannel = new BroadcastChannel('donation-sync');
                
                broadcastChannel.onmessage = (event) => {
                    if (event.data.type === 'DATA_UPDATE') {
                        // ë°›ì€ ë°ì´í„°ë¡œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì—…ë°ì´íŠ¸
                        const data = event.data.payload;
                        
                        localStorage.setItem('donation_data', JSON.stringify(data.donations || []));
                        localStorage.setItem('streamer_config', JSON.stringify(data.streamers || []));
                        localStorage.setItem('streamer_emojis', JSON.stringify(data.emojis || {}));
                        
                        // ì„¤ì •ë„ ë™ê¸°í™”
                        if (data.settings) {
                            Object.entries(data.settings).forEach(([key, value]) => {
                                localStorage.setItem(key, value);
                            });
                        }
                        
                        showBroadcastStatus('success', 'âœ… ë°ì´í„°ê°€ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                    }
                };
                
                showBroadcastStatus('success', 'âœ… ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì±„ë„ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                
            } catch (error) {
                showBroadcastStatus('warning', 'âŒ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì±„ë„ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.');
            }
        }
        
        function testBroadcast() {
            if (!broadcastChannel) {
                showBroadcastStatus('warning', 'ë¨¼ì € ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì±„ë„ì„ í™œì„±í™”í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì „ì†¡
            const testData = {
                type: 'DATA_UPDATE',
                payload: currentData || {
                    donations: [],
                    streamers: [],
                    emojis: {},
                    settings: {},
                    lastUpdated: new Date().toISOString()
                }
            };
            
            broadcastChannel.postMessage(testData);
            showBroadcastStatus('info', 'ğŸ“¡ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.');
        }
        
        // 4. í´ë¦½ë³´ë“œ ë™ê¸°í™” ë°©ì‹
        function exportToClipboard() {
            loadFromDonationManager();
            
            if (!currentData) {
                showClipboardStatus('warning', 'âŒ ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const dataString = JSON.stringify(currentData, null, 2);
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(dataString).then(() => {
                    showClipboardStatus('success', 'âœ… ë°ì´í„°ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                });
            }
        }
        
        function importFromClipboard() {
            if (navigator.clipboard) {
                navigator.clipboard.readText().then(text => {
                    try {
                        const data = JSON.parse(text);
                        
                        // ë°ì´í„° ê²€ì¦
                        if (data.donations && data.streamers) {
                            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                            localStorage.setItem('donation_data', JSON.stringify(data.donations));
                            localStorage.setItem('streamer_config', JSON.stringify(data.streamers));
                            localStorage.setItem('streamer_emojis', JSON.stringify(data.emojis || {}));
                            
                            // ì„¤ì •ë„ ë³µì›
                            if (data.settings) {
                                Object.entries(data.settings).forEach(([key, value]) => {
                                    localStorage.setItem(key, value);
                                });
                            }
                            
                            showClipboardStatus('success', 'âœ… í´ë¦½ë³´ë“œì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤!');
                        } else {
                            showClipboardStatus('warning', 'âŒ ì˜¬ë°”ë¥¸ ë°ì´í„° í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
                        }
                    } catch (error) {
                        showClipboardStatus('warning', 'âŒ í´ë¦½ë³´ë“œ ë°ì´í„°ë¥¼ í•´ì„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                });
            }
        }
        
        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function showStatus(type, message) {
            // ê¸°ì¡´ ìƒíƒœ ë©”ì‹œì§€ ì œê±°
            const existing = document.querySelector('.status.temp');
            if (existing) existing.remove();
            
            const status = document.createElement('div');
            status.className = `status ${type} temp`;
            status.innerHTML = message;
            
            document.querySelector('.method.active').appendChild(status);
            
            setTimeout(() => {
                if (status.parentNode) status.remove();
            }, 5000);
        }
        
        function showBroadcastStatus(type, message) {
            document.getElementById('broadcast-status').innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function showClipboardStatus(type, message) {
            document.getElementById('clipboard-status').innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ë°ì´í„° í™•ì¸
        window.addEventListener('load', () => {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸
            const donations = localStorage.getItem('donation_data');
            if (donations) {
                showStatus('info', 'â„¹ï¸ ê¸°ì¡´ ë°ì´í„°ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. "URL ìƒì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
            } else {
                showStatus('warning', 'âš ï¸ donation-manager.htmlì„ ë¨¼ì € ì—´ì–´ ë°ì´í„°ë¥¼ ë¡œë“œí•´ì£¼ì„¸ìš”.');
            }
        });
        
        // ë©”ì†Œë“œ ì„ íƒ ê¸°ëŠ¥
        document.querySelectorAll('.method').forEach(method => {
            method.addEventListener('click', () => {
                document.querySelectorAll('.method').forEach(m => m.classList.remove('active'));
                method.classList.add('active');
            });
        });
    </script>
</body>
</html>