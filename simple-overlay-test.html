<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ§ª ê°„ë‹¨ ì˜¤ë²„ë ˆì´ í…ŒìŠ¤íŠ¸</title>

<style>
body {
    margin: 0;
    padding: 20px;
    background: transparent;
    font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
    color: white;
}

.test-content {
    padding: 20px;
    background: rgba(0,0,0,0.8);
    border-radius: 10px;
    margin-bottom: 20px;
}

.control-panel {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0,0,0,0.9);
    padding: 15px;
    border-radius: 10px;
    border: 2px solid #fff;
}

.control-panel button {
    display: block;
    width: 100%;
    margin: 5px 0;
    padding: 8px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
}

.btn-left { background: #ff6b6b; color: white; }
.btn-center { background: #4ecdc4; color: white; }
.btn-right { background: #45b7d1; color: white; }
.btn-size { background: #96ceb4; color: white; }

#testText {
    font-size: 24px;
    font-weight: bold;
    color: white;
    text-shadow: 3px 3px 0 #000000, -3px -3px 0 #000000, 3px -3px 0 #000000, -3px 3px 0 #000000;
    text-align: left;
    transition: all 0.3s ease;
    line-height: 1.5;
    white-space: pre-line;
}
</style>
</head>
<body>

<div class="control-panel">
    <h4 style="color: white; margin: 0 0 10px 0;">ğŸ›ï¸ ì¦‰ì‹œ í…ŒìŠ¤íŠ¸</h4>
    <button class="btn-left" onclick="setAlign('left')">â† ì™¼ìª½</button>
    <button class="btn-center" onclick="setAlign('center')">âš¬ ê°€ìš´ë°</button>
    <button class="btn-right" onclick="setAlign('right')">â†’ ì˜¤ë¥¸ìª½</button>
    <button class="btn-size" onclick="changeSize('+')">ğŸ” í¬ê²Œ</button>
    <button class="btn-size" onclick="changeSize('-')">ğŸ” ì‘ê²Œ</button>
    <button onclick="showInfo()" style="background: #feca57; color: black;">â„¹ï¸ ì •ë³´</button>
</div>

<div class="test-content">
    <div id="testText">ì‚¬ë‘í•´ìš”â™¡
í™ê¸¸ë™ë‹˜ 10ë§Œì›
ê¹€ì² ìˆ˜ë‹˜ 5ë§Œì›
ì´ì˜í¬ë‹˜ 3ë§Œì›</div>
</div>

<div class="test-content">
    <h3 style="color: #feca57;">ğŸ“Š í˜„ì¬ ì„¤ì • ìƒíƒœ:</h3>
    <div id="statusInfo" style="color: #ddd; font-family: monospace;"></div>
</div>

<script>
let currentSize = 24;

// ì •ë ¬ ë³€ê²½
function setAlign(align) {
    console.log('ğŸ¯ ì •ë ¬ ë³€ê²½:', align);
    
    const textEl = document.getElementById('testText');
    
    // 1. CSS style ì§ì ‘ ì ìš©
    textEl.style.textAlign = align;
    
    // 2. cssTextë¡œ ê°•ì œ ì ìš©
    textEl.style.cssText = `
        font-size: ${currentSize}px;
        font-weight: bold;
        color: white;
        text-shadow: 3px 3px 0 #000000, -3px -3px 0 #000000, 3px -3px 0 #000000, -3px 3px 0 #000000;
        text-align: ${align};
        transition: all 0.3s ease;
        line-height: 1.5;
        white-space: pre-line;
    `;
    
    // 3. localStorageì— ì €ì¥
    localStorage.setItem('overlay-text-align', align);
    localStorage.setItem('overlay-font-size', currentSize.toString());
    
    // 4. ì„œë²„ì— ì „ì†¡
    sendToServer(align, currentSize);
    
    updateStatus();
    
    // ì‹œê°ì  í”¼ë“œë°±
    textEl.style.backgroundColor = 'rgba(255,255,255,0.1)';
    setTimeout(() => {
        textEl.style.backgroundColor = 'transparent';
    }, 500);
}

// í¬ê¸° ë³€ê²½
function changeSize(direction) {
    if (direction === '+') {
        currentSize += 4;
    } else {
        currentSize = Math.max(12, currentSize - 4);
    }
    
    console.log('ğŸ“ í¬ê¸° ë³€ê²½:', currentSize);
    
    const textEl = document.getElementById('testText');
    const align = textEl.style.textAlign || 'left';
    
    // cssTextë¡œ ëª¨ë“  ìŠ¤íƒ€ì¼ ë‹¤ì‹œ ì ìš©
    textEl.style.cssText = `
        font-size: ${currentSize}px;
        font-weight: bold;
        color: white;
        text-shadow: 3px 3px 0 #000000, -3px -3px 0 #000000, 3px -3px 0 #000000, -3px 3px 0 #000000;
        text-align: ${align};
        transition: all 0.3s ease;
        line-height: 1.5;
        white-space: pre-line;
    `;
    
    localStorage.setItem('overlay-font-size', currentSize.toString());
    localStorage.setItem('overlay-text-align', align);
    
    sendToServer(align, currentSize);
    updateStatus();
}

// ì„œë²„ì— ì„¤ì • ì „ì†¡
async function sendToServer(align, size) {
    try {
        console.log('ğŸ“¡ ì„œë²„ ì „ì†¡:', { align, size });
        
        const settings = {
            'overlay-text-align': align,
            'overlay-font-size': size.toString(),
            'overlay-stroke-width': '3'
        };
        
        const response = await fetch('/api/settings', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ settings })
        });
        
        if (response.ok) {
            console.log('âœ… ì„œë²„ ì „ì†¡ ì„±ê³µ');
        } else {
            console.warn('âš ï¸ ì„œë²„ ì „ì†¡ ì‹¤íŒ¨');
        }
        
    } catch (error) {
        console.error('âŒ ì„œë²„ ì „ì†¡ ì˜¤ë¥˜:', error);
    }
}

// ìƒíƒœ ì •ë³´ ì—…ë°ì´íŠ¸
function updateStatus() {
    const textEl = document.getElementById('testText');
    const computed = window.getComputedStyle(textEl);
    
    const info = `í˜„ì¬ ì ìš©ëœ ìŠ¤íƒ€ì¼:
â€¢ í°íŠ¸ í¬ê¸°: ${computed.fontSize}
â€¢ í…ìŠ¤íŠ¸ ì •ë ¬: ${computed.textAlign}
â€¢ í°íŠ¸ êµµê¸°: ${computed.fontWeight}
â€¢ ìƒ‰ìƒ: ${computed.color}

localStorage:
â€¢ overlay-font-size: ${localStorage.getItem('overlay-font-size') || 'ì—†ìŒ'}
â€¢ overlay-text-align: ${localStorage.getItem('overlay-text-align') || 'ì—†ìŒ'}

inline style:
${textEl.style.cssText}

ë³€ìˆ˜:
â€¢ currentSize: ${currentSize}px`;

    document.getElementById('statusInfo').textContent = info;
}

// ì •ë³´ í‘œì‹œ
function showInfo() {
    alert(`ğŸ§ª ê°„ë‹¨ ì˜¤ë²„ë ˆì´ í…ŒìŠ¤íŠ¸

ì´ í˜ì´ì§€ëŠ” ì„¤ì •ì´ ì œëŒ€ë¡œ ì ìš©ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ê°„ë‹¨í•œ ì˜¤ë²„ë ˆì´ì…ë‹ˆë‹¤.

ì‚¬ìš©ë²•:
â€¢ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì¦‰ì‹œ ìŠ¤íƒ€ì¼ ë³€ê²½
â€¢ ë³€ê²½ì‚¬í•­ì€ localStorageì™€ ì„œë²„ì— ì €ì¥
â€¢ ì‹¤ì‹œê°„ìœ¼ë¡œ ì ìš©ëœ ìŠ¤íƒ€ì¼ í™•ì¸ ê°€ëŠ¥

ë§Œì•½ ì´ í˜ì´ì§€ì—ì„œë„ ì„¤ì •ì´ ì•ˆ ëœë‹¤ë©´ ë¸Œë¼ìš°ì € ìºì‹œë‚˜ ë‹¤ë¥¸ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
}

// ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', () => {
    // localStorageì—ì„œ ì„¤ì • ë¡œë“œ
    const savedSize = localStorage.getItem('overlay-font-size');
    const savedAlign = localStorage.getItem('overlay-text-align');
    
    if (savedSize) {
        currentSize = parseInt(savedSize);
    }
    
    if (savedAlign) {
        setAlign(savedAlign);
    } else {
        updateStatus();
    }
    
    console.log('ğŸš€ ê°„ë‹¨ í…ŒìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ ì‹œì‘');
    console.log('ì €ì¥ëœ ì„¤ì •:', { savedSize, savedAlign });
});

// 1ì´ˆë§ˆë‹¤ ìƒíƒœ ì—…ë°ì´íŠ¸
setInterval(updateStatus, 1000);

// í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
document.addEventListener('keydown', (e) => {
    switch(e.key) {
        case '1':
            setAlign('left');
            break;
        case '2':
            setAlign('center');
            break;
        case '3':
            setAlign('right');
            break;
        case '+':
            changeSize('+');
            break;
        case '-':
            changeSize('-');
            break;
        case 'i':
        case 'I':
            showInfo();
            break;
    }
});
</script>

</body>
</html>