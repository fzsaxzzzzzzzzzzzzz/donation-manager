<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê°„ë‹¨ í…ŒìŠ¤íŠ¸</title>
<style>
body { 
    font-family: Arial, sans-serif; 
    margin: 20px; 
    background: #f0f2f5; 
}
.container { 
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    max-width: 1200px;
    margin: 0 auto;
}
.panel { 
    background: white; 
    padding: 20px; 
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.btn { 
    background: #1877f2; 
    color: white; 
    border: none; 
    padding: 10px 20px; 
    border-radius: 6px;
    cursor: pointer;
}
.status { 
    padding: 10px; 
    border-radius: 6px; 
    margin: 10px 0;
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffeaa7;
}
</style>
</head>
<body>

<h1>í›„ì› ê´€ë¦¬ ì‹œìŠ¤í…œ - í…ŒìŠ¤íŠ¸ ë²„ì „</h1>

<div class="container">
    <div class="panel">
        <h2>ğŸ¤– ì±—ë´‡</h2>
        <div id="chatbot-status" class="status">
            ğŸ” <strong>Google ë¡œê·¸ì¸ í•„ìš”</strong>: YouTube API ì‚¬ìš©ì„ ìœ„í•´ ë¡œê·¸ì¸í•˜ì„¸ìš”. 
            <button onclick="signInGoogle()" class="btn" style="margin-left:10px;">ë¡œê·¸ì¸</button>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h4>ğŸ”§ YouTube API í…ŒìŠ¤íŠ¸</h4>
            <button onclick="testApi()" class="btn">API ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h4>ğŸ“º ë¼ì´ë¸Œ ì±„íŒ… ì—°ê²°</h4>
            <input type="text" id="youtube-video-id" placeholder="YouTube ì˜ìƒ ID" style="width: 70%; padding: 8px;">
            <button onclick="connectChat()" class="btn">ì—°ê²°</button>
        </div>
    </div>
    
    <div class="panel">
        <h2>ğŸ“Š í˜„í™©</h2>
        <div id="status-display">
            ì‹œìŠ¤í…œì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!
        </div>
        <button onclick="testFunction()" class="btn">í…ŒìŠ¤íŠ¸</button>
    </div>
</div>

<script src="https://apis.google.com/js/api.js"></script>
<script src="https://accounts.google.com/gsi/client"></script>

<script>
// ê¸°ë³¸ ì„¤ì •
const GOOGLE_CONFIG = {
    CLIENT_ID: '493287022430-4mmnh4stu22p13lr0sjgvpg0nbkouova.apps.googleusercontent.com',
    API_KEY: 'AIzaSyBz5aGfiAQCrfi0ccydGypD0leYjLUt4t4',
    DISCOVERY_DOCS: [
        'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest',
        'https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest'
    ],
    SCOPES: 'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/youtube https://www.googleapis.com/auth/youtube.force-ssl'
};

let isSignedIn = false;
let authInstance = null;

// ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
function testFunction() {
    document.getElementById('status-display').innerHTML = 'í…ŒìŠ¤íŠ¸ ë²„íŠ¼ì´ í´ë¦­ë˜ì—ˆìŠµë‹ˆë‹¤! âœ…';
}

// Google API ì´ˆê¸°í™”
async function initGoogleAPI() {
    try {
        await new Promise((resolve) => {
            gapi.load('client:auth2', resolve);
        });
        
        // í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
        await gapi.client.init({
            apiKey: GOOGLE_CONFIG.API_KEY,
            discoveryDocs: GOOGLE_CONFIG.DISCOVERY_DOCS
        });
        
        // OAuth2 ë³„ë„ ì´ˆê¸°í™”
        await gapi.auth2.init({
            client_id: GOOGLE_CONFIG.CLIENT_ID,
            scope: GOOGLE_CONFIG.SCOPES
        });
        
        authInstance = gapi.auth2.getAuthInstance();
        isSignedIn = authInstance.isSignedIn.get();
        
        authInstance.isSignedIn.listen((signedIn) => {
            isSignedIn = signedIn;
            updateStatus();
        });
        
        updateStatus();
        console.log('Google API ì´ˆê¸°í™” ì™„ë£Œ');
        
    } catch (error) {
        console.error('Google API ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        document.getElementById('status-display').innerHTML = `âŒ API ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`;
    }
}

// Google ë¡œê·¸ì¸
async function signInGoogle() {
    try {
        if (!authInstance) {
            alert('Google APIê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
            return;
        }
        
        await authInstance.signIn();
        document.getElementById('status-display').innerHTML = 'âœ… Google ë¡œê·¸ì¸ ì„±ê³µ!';
        
    } catch (error) {
        console.error('ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);
        document.getElementById('status-display').innerHTML = `âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ${error.message}`;
    }
}

// ìƒíƒœ ì—…ë°ì´íŠ¸
function updateStatus() {
    const statusElement = document.getElementById('chatbot-status');
    if (isSignedIn) {
        statusElement.innerHTML = 'âœ… <strong>Google ë¡œê·¸ì¸ë¨</strong>: YouTube APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! <button onclick="signOutGoogle()" class="btn" style="margin-left:10px;">ë¡œê·¸ì•„ì›ƒ</button>';
    } else {
        statusElement.innerHTML = 'ğŸ” <strong>Google ë¡œê·¸ì¸ í•„ìš”</strong>: YouTube API ì‚¬ìš©ì„ ìœ„í•´ ë¡œê·¸ì¸í•˜ì„¸ìš”. <button onclick="signInGoogle()" class="btn" style="margin-left:10px;">ë¡œê·¸ì¸</button>';
    }
}

// API í…ŒìŠ¤íŠ¸
function testApi() {
    if (!isSignedIn) {
        document.getElementById('status-display').innerHTML = 'âŒ ë¨¼ì € Google ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
        return;
    }
    document.getElementById('status-display').innerHTML = 'ğŸ” YouTube API í…ŒìŠ¤íŠ¸ ì¤‘...';
    // ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ë§Œ
    setTimeout(() => {
        document.getElementById('status-display').innerHTML = 'âœ… API í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
    }, 1000);
}

// ì±„íŒ… ì—°ê²° í…ŒìŠ¤íŠ¸
function connectChat() {
    const videoId = document.getElementById('youtube-video-id').value.trim();
    if (!videoId) {
        document.getElementById('status-display').innerHTML = 'âŒ YouTube ì˜ìƒ IDë¥¼ ì…ë ¥í•˜ì„¸ìš”';
        return;
    }
    document.getElementById('status-display').innerHTML = `ğŸ”— ì˜ìƒ ID: ${videoId}ë¡œ ì—°ê²° ì‹œë„ ì¤‘...`;
}

// ë¡œê·¸ì•„ì›ƒ
async function signOutGoogle() {
    try {
        await authInstance.signOut();
        document.getElementById('status-display').innerHTML = 'ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤';
    } catch (error) {
        console.error('ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:', error);
    }
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
window.addEventListener('load', async () => {
    document.getElementById('status-display').innerHTML = 'ğŸš€ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘...';
    await initGoogleAPI();
    document.getElementById('status-display').innerHTML = 'âœ… ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ!';
});
</script>

</body>
</html>